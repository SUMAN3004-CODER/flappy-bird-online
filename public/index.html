<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird Multiplayer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Press Start 2P',cursive;background-color:#87ceeb;overflow:hidden;color:#1a202c}.screen{display:none}.active{display:flex}.btn{background-color:#4caf50;border:none;color:#fff;padding:15px 32px;text-align:center;text-decoration:none;display:inline-block;font-size:16px;margin:4px 2px;cursor:pointer;border-radius:8px;box-shadow:0 4px #999;transition:all .1s ease-in-out}.btn:active{box-shadow:0 2px #666;transform:translateY(2px)}.btn-google{background-color:#db4437}.btn-guest{background-color:#757575}.btn-logout{background-color:#f44336}.card{background-color:rgba(255,255,255,.8);border-radius:16px;box-shadow:0 8px 16px rgba(0,0,0,.2);backdrop-filter:blur(5px);border:2px solid rgba(255,255,255,.9)}#gameCanvas{background-color:#87ceeb;display:block;width:100%;height:100%;}.modal{display:none;position:fixed;z-index:100;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.6);backdrop-filter:blur(5px)}.modal-content{background-color:#fefefe;margin:15% auto;padding:20px;border:1px solid #888;width:80%;max-width:500px;border-radius:16px}.tab-btn{border:none;background:none;padding:10px 15px;cursor:pointer;border-bottom:3px solid transparent}.tab-btn.active{border-bottom:3px solid #4CAF50}.tab-content{display:none}.tab-content.active{display:block}
        /* Dark Mode Styles */
        body.dark{background-color:#0d1117;color:#c9d1d9}body.dark #gameCanvas{background-color:#0d1117}body.dark .card{background-color:rgba(22,27,34,.8);border-color:rgba(139,148,158,.2)}body.dark .btn{background-color:#238636}body.dark .btn-logout{background-color:#da3633}body.dark .modal-content{background-color:#161b22}
    </style>
</head>
<body class="w-screen h-screen flex items-center justify-center p-4">
    <!-- Sound Effects -->
    <audio id="flap-sound" src="https://www.soundjay.com/button/sounds/button-4.mp3" preload="auto"></audio>
    <audio id="score-sound" src="https://www.soundjay.com/button/sounds/button-3.mp3" preload="auto"></audio>
    <audio id="gameover-sound" src="https://www.soundjay.com/button/sounds/button-10.mp3" preload="auto"></audio>

    <div id="loading-screen" class="screen active flex-col items-center justify-center h-full w-full">
        <h1 class="text-4xl mb-4">Flappy Bird</h1><p class="text-lg">Connecting...</p>
    </div>

    <div id="login-screen" class="screen flex-col items-center justify-center h-full w-full">
        <div class="card p-8 text-center w-full max-w-sm">
            <h1 class="text-4xl mb-6">Login</h1>
            <a href="/auth/google" class="btn btn-google w-full mb-4">Login with Google</a>
            <button id="guest-login-btn" class="btn btn-guest w-full">Continue as Guest</button>
        </div>
    </div>

    <div id="main-menu-screen" class="screen flex-col items-center justify-center h-full w-full">
        <div class="card p-8 text-center w-full max-w-sm">
            <h1 class="text-3xl mb-4" id="welcome-message">Main Menu</h1>
            <p class="mb-2 text-xs">Your ID (for friends):</p>
            <p id="user-id-display" class="mb-4 text-sm bg-gray-200 p-2 rounded break-all cursor-pointer" title="Click to copy">Login with Google to get an ID</p>
            <button id="single-player-btn" class="btn w-full mb-4">Single Player</button>
            <button id="multiplayer-btn" class="btn w-full">Multiplayer</button>
        </div>
        <a href="/auth/logout" id="logout-btn" class="btn btn-logout mt-6">Logout</a>
    </div>

    <div id="multiplayer-lobby-screen" class="screen flex-col items-center justify-center h-full w-full">
        <div class="card p-6 text-center w-full max-w-2xl">
            <div class="flex border-b justify-center">
                <button class="tab-btn active" data-tab="my-friends">My Friends</button>
                <button class="tab-btn" data-tab="add-friend">Add Friend</button>
                <button class="tab-btn" data-tab="leaderboards">Leaderboards</button>
                <button class="tab-btn" data-tab="settings">Settings</button>
            </div>
            <div class="mt-4">
                <div id="my-friends-tab" class="tab-content active"><div id="friends-list" class="max-h-64 overflow-y-auto"></div></div>
                <div id="add-friend-tab" class="tab-content">
                    <input id="add-friend-input" type="text" placeholder="Enter Friend's ID" class="w-full p-2 border rounded mb-2 text-center">
                    <button id="add-friend-btn" class="btn w-full">Send Friend Request</button>
                </div>
                <div id="leaderboards-tab" class="tab-content"><div id="leaderboard-content" class="max-h-64 overflow-y-auto"></div></div>
                <div id="settings-tab" class="tab-content">
                    <h2 class="text-xl mb-4">Game Settings</h2>
                    <div class="flex items-center justify-center mb-6">
                        <label for="dark-mode-toggle" class="mr-4">Dark Mode</label>
                        <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                            <input type="checkbox" id="dark-mode-toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                            <label for="dark-mode-toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg mb-2">Single Player Difficulty</h3>
                        <div id="difficulty-selection" class="flex justify-center space-x-4">
                            <label><input type="radio" name="difficulty" value="easy" checked> Easy</label>
                            <label><input type="radio" name="difficulty" value="medium"> Medium</label>
                            <label><input type="radio" name="difficulty" value="hard"> Hard</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button id="lobby-back-btn" class="btn mt-4">Back to Menu</button>
    </div>

    <div id="game-screen" class="screen flex-col items-center justify-center h-full w-full">
        <div class="w-full h-full relative">
            <div id="scores" class="absolute top-0 left-0 right-0 flex justify-between p-4 text-white text-2xl z-10" style="text-shadow: 2px 2px 4px #000000;">
                <p>You: <span id="local-score">0</span></p>
                <p class="hidden" id="opponent-score-display">Friend: <span id="opponent-score">0</span></p>
            </div>
            <canvas id="gameCanvas"></canvas>
            <div id="game-over-message" class="absolute inset-0 hidden flex-col items-center justify-center bg-black bg-opacity-50 z-20">
                <p id="game-over-text" class="text-white text-4xl">Game Over</p>
                <button id="restart-btn" class="btn mt-4">Play Again</button>
                <button id="game-back-btn" class="btn mt-4">Main Menu</button>
            </div>
        </div>
    </div>
    
    <div id="invite-modal" class="modal"><div class="modal-content text-center"><h2 class="text-2xl mb-4">Game Invite!</h2><p id="invite-from-text" class="mb-6"></p><div class="flex justify-around"><button id="accept-invite-btn" class="btn">Accept</button><button id="decline-invite-btn" class="btn btn-logout">Decline</button></div></div></div>
    <div id="difficulty-modal" class="modal"><div class="modal-content text-center"><h2 class="text-2xl mb-4">Choose Difficulty</h2><div id="difficulty-choices" class="flex justify-center space-x-4 mb-4"><button data-difficulty="easy" class="btn">Easy</button><button data-difficulty="medium" class="btn">Medium</button><button data-difficulty="hard" class="btn">Hard</button></div><div id="difficulty-status"><p>You: <span id="my-difficulty-choice">Waiting...</span></p><p id="opponent-name">Opponent</p>: <span id="opponent-difficulty-choice">Waiting...</span></div></div></div>
    
    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
</body>
</html>

